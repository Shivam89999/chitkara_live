var allowedNotificationType=["success","error","normal"];function getNotification(e,n){return $(`<div class='notification ${e}_notification'>\n    <div class='message'>${n}</div>\n            \n            <div class='indicator'></div>\n        </div>`)}function removeNotification(e){e.css("pointer-events","none"),e.css("transform","translateX(-105%)"),window.setTimeout(function(){e.css("transform","translateX(0)"),window.setTimeout(()=>{e.remove()},250)},250)}function setRemoveTime(e){return $(".indicator",e).animate({width:"0"},1500,"linear"),window.setTimeout(function(){removeNotification(e)},1500)}function handleNotification(e,n){if(0==n.length)return void console.log("empty notification not allowed");if(!allowedNotificationType.includes(e))return void console.log("given type is not allowed ",e);let t=$("#notifications"),o=getNotification(e,n);t.append(o),window.setTimeout(function(){o.css("transform","translateX(-105%)"),window.setTimeout(function(){o.css("transform","translateX(-100%)")},250)},10);let i=setRemoveTime(o);o.hover(function(){clearInterval(i),$(".indicator",o).stop(),$(".indicator",o).css("width","100%")},function(){i=setRemoveTime(o)})}function domLoader(){return $('<div class="loader">\n                        <div class="loading">\n                            <div class="loading-box"></div>\n                            <div class="loading-box"></div>\n                            <div class="loading-box"></div>\n                            <div class="loading-box"></div>\n                        </div>\n                        <span class=\'loader-content\'>processing....</span>\n                    </div>')}function addLoader(e){let n=$(".loading",e),t=$(".loading-box",n);console.log("loader is ",n),console.log("box is ",t);let o=0;return setInterval(()=>{$(t[o]).toggleClass("active-loading"),o=(o+1)%4},100)}function removeLoader(e,n){clearInterval(n),$(e).remove()}function listenerToAddNewComment(){$(".some").each((e,n)=>{addNewComment(n)})}function addNewComment(e){$(e).submit(function(n){n.preventDefault();let t=domLoader();t.insertAfter($(e).parent());let o=addLoader(t);$(e).toggleClass(" disable_btn_without_back"),$.ajax({type:"POST",url:$(e).prop("action"),data:$(e).serialize(),success:function(n){console.log("data is ",n.data);let i=addNewCommentToDOM(n.data.comment,n.data.post);$(`#all-comment-${n.data.post._id}`).prepend(i),$(`#all-comment-${n.data.post._id}>.no-comment`).remove(),$(`#comment-head-${n.data.post._id}`).text(n.data.post.comments.length+"  Comments"),$(`#comment-length-${n.data.post._id}`).text(n.data.post.comments.length+"  comments"),handleToggleCommentLike($(`#toggle-comment-like-link-${n.data.comment._id}`,i)),"none"==$(`#comment-${n.data.post._id}`).css("display")&&toggleComment(n.data.post._id,n.data.post.photos?"Post":"Text"),handleNotification("success",n.message),$(e).trigger("reset"),removeLoader(t,o),$(e).toggleClass(" disable_btn_without_back")},error:function(n,i){if(removeLoader(t,o),$(e).toggleClass(" disable_btn_without_back"),401==n.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);console.log("err is ^^^^^^^^^ ",n.responseJSON.err),$(e).trigger("reset")}})})}function addNewCommentToDOM(e,n){return $(`<div class="comment" id="comment-id-${e._id}">\n                        <div class="upper-div-1">\n                            <a href="/user/profile?user_id=${e.creator._id}" style="text-decoration: none">\n                                <div>\n                                    <img src="${e.creator.pic}" alt="img" height="30px" width="30px" style="border-radius: 50%" />\n                                </div>\n                            </a>\n                            <div>\n                                <a href="/user/profile?user_id=${e.creator._id}" style="text-decoration: none; color: rgb(117, 112, 112)">\n                                    <span>${e.creator.name}</span>\n                                </a>\n                                <span class="comment-content">${e.content}</span>\n                            </div>\n                        </div>\n                        <div class="upper-div-2">\n                            <div>\n                                <span><a href="/user/toggle-like?id=${e._id}&type=Comment"\n                                class="toggle-comment-like-link"\n              id="toggle-comment-like-link-${e._id}"\n              ><span id="toggle-comment-like-span-${e._id}">\n                \n                <img\n                  src="https://cdn-icons-png.flaticon.com/512/151/151910.png"\n                  alt=""\n                  height="25px"\n                  width="25px"\n                />\n              \n              </span></a>\n                                </span><span id="comment-like-count-${e._id}">${e.likes.length}</span>\n                            </div>\n\n                                <div>\n                                    <span onClick="handleEditCommentOption(event)"  class="edit-comment" link="/user/delete-comment?comment=${e._id}&post=${n._id}&type=${n.photos?"Post":"TextPost"}">&vellip;</span\n          >\n        </div>\n        \n                        </div>\n                    </div>`)}function handleLikeIconAndCount(e,n,t){let o=$(`#toggle-${t}-like-span-${e._id}`),i=$(`#${t}-like-count-${e._id}`);o.html(""),i.html(""),n?o.html('<img\n                  src="/uploads/icons/3.liked.png"\n                  alt="yes likes"\n                  height="25px"\n                  width="25px"\n                 style=\'color:red;\'\n                />'):o.html('<img\n                  src="/uploads/icons/4.not_liked.png"\n                  alt="no"\n                  height="25px"\n                  width="25px"\n                \n                />'),i.html(`${e.likes.length}`),"post"==t&&i.html(`${e.likes.length} likes`)}function handleToggleCommentLike(e){$(e).click(function(n){n.preventDefault(),$.ajax({type:"GET",url:$(e).prop("href"),success:function(e){console.log("data is ",e),handleLikeIconAndCount(e.data.comment,!!e.data.like,"comment"),handleNotification("success",e.message)},error:function(e,n){if(401==e.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);console.log("err is ",n.responseText),handleNotification("error",e.responseJSON.err)}})})}function addLikesUserBar(e){var n=` <div class="first-div"><span>${e.likes.length} people are liked this post</span> <span><a href="/user/likes?post=${e._id}&type=${e.photos?"Post":"TextPost"}">View All</a></span></div>\n                            <div>`;for(let t=0;t<7&&t<e.likes.length;t++)n+=`<img src="${e.likes[t].creator.pic}" alt="pic" height="40px" width="40px" style="border-radius: 50%; padding:0px 7px 0px 7px;">`;return n+="</div>",$(n)}function tooggleCommentLikes(){$(".toggle-comment-like-link").each((e,n)=>{handleToggleCommentLike(n)})}function togglePostLike(){$(".post-like-toggle").each((e,n)=>{handleTogglePostLike(n)})}function handleTogglePostLike(e){$(e).click(n=>{n.preventDefault(),$.ajax({type:"GET",url:$(e).prop("href"),success:function(e){let n=e.data.post;handleLikeIconAndCount(n,!!e.data.like,"post");let t=$(`#likes-detail-${n._id}`);t.html(""),n.likes.length>0&&t.append(addLikesUserBar(n)),handleNotification("success",e.message)},error:function(e,n){if(401==e.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);console.log("err is ",n.responseText),handleNotification("error",e.responseJSON.err)}})})}function handleSaveImgDisplay(e){return e?$('<img\n          src="/uploads/icons/33.saved.png"\n          height="25px"\n          width="20px"\n          alt=""\n      />'):$('<img\n          src="/uploads/icons/34.not-saved.png"\n          height="25px"\n          width="20px"\n          alt=""\n      />')}function handleToggleSave(e){$(e).click(n=>{n.preventDefault(),$(e).toggleClass(" disable_btn_without_back"),$.ajax({type:"GET",url:$(e).prop("href"),success:function(n){console.log("data is ",n);let t=$(`#save-toggle-link-${n.data.target._id}`);t.html(""),t.append(handleSaveImgDisplay(!!n.data.state)),handleNotification("success",n.message),$(e).toggleClass(" disable_btn_without_back")},error:function(n,t){if(401==n.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);handleNotification("error",n.responseJSON.err),console.log("err is ",t.responseText),$(e).toggleClass(" disable_btn_without_back")}})})}function toggleSavePost(){$(".save-toggle-link").each((e,n)=>{handleToggleSave(n)})}function deleteComment(e){$(e).click(n=>{n.preventDefault(),$(e).toggleClass(" disable_btn_without_back"),$.ajax({type:"GET",url:$(e).prop("href"),success:function(n){console.log("data is ^^ ",n),$(`#comment-id-${n.data.commentId}`).remove(),$(`#comment-head-${n.data.postId}`).text(n.data.commentLength+"  Comments"),$(`#comment-length-${n.data.postId}`).text(n.data.commentLength+"  comments"),0==n.data.commentLength&&$(`#all-comment-${n.data.postId}`).append($('<div class="comment no-comment" style="text-align: center; color: rgb(31, 29, 29); box-shadow: none">\n                No comments for this post\n            </div>')),$(e).toggleClass(" disable_btn_without_back"),handleNotification("success",n.message)},error:function(n,t){if($(e).toggleClass(" disable_btn_without_back"),401==n.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);console.log("err is",t),handleNotification("error",n.responseJSON.err)}})})}function handleDeleteComment(){$(".delete-comment-link").each((e,n)=>{deleteComment(n)})}function handleEditCommentOption(e){let n=e.target;console.log("targte ele is ",n);let t=document.createElement("div");t.className="toUpdateComment",t.className+=" clickDisappear";let o=n.getAttribute("link");var i=document.createElement("a");i.innerHTML="<img src='/uploads/icons/41.delete.png' alt='delete' height='30px' width='22px' />",i.href=o,i.className="delete-comment-link",t.appendChild(i),console.log("D is ",t),console.log("paren t ************** ",n.parentNode.parentNode),n.parentNode.parentNode.parentNode.appendChild(t),deleteComment($(i))}function handleEditPostOption(e){let n=e.target,t=parseInt(n.getAttribute("id")),o=document.createElement("div");o.id="toUpdate-"+t,o.className="toUpdate",o.className+=" clickDisappear";let i=n.getAttribute("link");var a=document.createElement("a");a.innerHTML="<img src='/uploads/icons/41.delete.png' alt='delete' style='padding-left:5px;padding-top:4px;' height='30px' width='22px' />",a.href=i,a.id=t,a.className="delete-post-link",o.appendChild(a),console.log("D is ",o),console.log("to add is "),document.getElementById("post-"+t).appendChild(o),deletePost($(a))}function handleDeletePost(){$(".delete-post-link").each(e=>{console.log("delete post links are ",e),deletePost(e)})}function deletePost(e){console.log("%%%%%%%%%%%%%%5 66  : ",$(e)),$(e).click(n=>{console.log("$$$$$$$$$$$$$$$$$$$$$$  ^^^^^^ "),n.preventDefault(),$(e).toggleClass(" disable_btn_without_back");let t=$(e).prop("id");$.ajax({type:"GET",url:$(e).prop("href"),success:function(n){console.log("data is ",n),$(`#post-${t}`).remove(),console.log("data postId ",n.data.postId),$(`#comment-${n.data.postId}`).remove(),$(e).toggleClass(" disable_btn_without_back"),handleNotification("success",n.message)},error:function(n,t){if(401==n.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);handleNotification("error",n.responseJSON.err),$(e).toggleClass(" disable_btn_without_back"),console.log("err is ",n.responseJSON.err)}})})}function getLoginForm(){return $('<form action="/create-session" id="login-form-page" method="POST">\n          <input\n            class="input login"\n            required\n            type="text"\n            name="email"\n            oninput="handleInputChange(event)"\n            onfocus="handleInputChange(event)"\n            placeholder="Email*"\n          />\n\n          <input\n            class="input login"\n            required\n            type="password"\n            name="password"\n            id=""\n            placeholder="Password*"\n            onfocus="slideup(event)"\n            onfocusout="slidedown(event)"\n          />\n          \n         <span class=\'forgot-link\' >forgot password</span>\n         \n\n          <button style="margin-left: 45px">Sign in</button>\n        </form>\n          <a href="/auth/google" id="google-with">\n          <img\n            src="https://www.transparentpng.com/thumb/google-logo/google-logo-png-icon-free-download-SUF63j.png"\n            alt="logo"\n            height="40px"\n            width="40px"\n          />\n          <span>Google continue</span>\n        </a>\n\n        ')}function showSignInPage(){slidedown("vmk");let e=$("#login-form");e.html(""),e.append(getLoginForm()),forgotPasswordListener($(".forgot-link",e))}function forgotPasswordListener(e){e.click(function(e){e.preventDefault(),console.log("some %%%%%%%%%%%%%%%%%%% 00"),slidedown("jhcdh");let n=$("#login-form");n.html("");let t=getOtpForm("/forgot-password-send-otp");n.append(t),getOtp(t)})}function getOtp(e){e.submit(n=>{n.preventDefault(),$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn"),$.ajax({method:"POST",url:e.prop("action"),data:e.serialize(),success:function(n){console.log("message is ",n),"signUp"==n.data.type?show_email_verification_page(n.data.email,"/sign-up-email-verification",`/resend-sign-up-otp-email?email=${n.data.email}`):"forgotPassword"==n.data.type&&show_email_verification_page(n.data.email,"/forgot-password-email-verification",`/resend-forgot-password-otp-email?email=${n.data.email}`),$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn"),handleNotification("success",n.message)},error:function(n,t){if(401==n.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);handleNotification("error",n.responseJSON.err),$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn"),console.log("err is ",n.responseJSON.err)}})})}function getOtpForm(e){return $(`<form action="${e}"  method="POST">\n          <input\n            class="input get-otp"\n            required\n            type="text"\n            name="email"\n            oninput="handleInputChange(event)"\n            onfocus="handleInputChange(event)"\n            placeholder="Email*"\n            style="margin-top: 10px"\n          \n          />\n\n          <button>Get otp</button>\n        </form>\n        \n         <a href="/auth/google" id="google-with">\n          <img\n            src="https://www.transparentpng.com/thumb/google-logo/google-logo-png-icon-free-download-SUF63j.png"\n            alt="logo"\n            height="40px"\n            width="40px"\n          />\n          <span>Google continue</span>\n        </a>\n        \n        \n        `)}function showSignUpGetOtpPage(){slidedown("jhcdh");let e=$("#login-form");e.html("");let n=getOtpForm("/sign-up-send-otp");e.append(n),getOtp(n)}function otp_email_verification_form(e,n,t){return $(`<form action="${n}" id="sign-up-email-verification-form" method="POST">\n          <input\n            class="input otp-verify"\n            required\n            type="text"\n            name="email"\n            oninput="handleInputChange(event)"\n            onfocus="handleInputChange(event)"\n            placeholder="Email*"\n            value="${e}"\n            style="pointer-events: none; opacity: 0.5"\n            autocomplete='off'\n          />\n\n          <input\n            class="input otp-verify"\n            required\n            type="password"\n            name="otp"\n            id=""\n            placeholder="Otp *"\n            onfocus="slideup(event)"\n            onfocusout="slidedown(event)"\n            autocomplete='off'\n          />\n          <div style="text-align: center; margin-top: 7px">\n            <a\n              href="${t}"\n              class="resend-link"\n              >Resend Otp</a\n            >\n          </div>\n          <button>Verify email</button>\n        </form>`)}function show_email_verification_page(e,n,t){slidedown("jhcdh");let o=$("#login-form");o.html("");let i=otp_email_verification_form(e,n,t);o.append(i),verifyEmail(i),otp_resend_option($(" .resend-link",i))}function show_SignUp_intial_dataForm(e){slidedown("jhcdh");let n=$("#login-form");n.html("");let t=get_sign_up_initial_data_form(e);n.append(t),sendIntialData(t)}function show_Set_Password_Form(e){slidedown("jhcdh");let n=$("#login-form");n.html("");let t=getSetPasswordForm(e);n.append(t),sendIntialData(t)}function sendIntialData(e){console.log("intialdataform is ~~~~~~~~~~~~~~~~~~~~~~ ",e),e.submit(n=>{n.preventDefault(),$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn"),$.ajax({method:"POST",url:e.prop("action"),data:e.serialize(),success:function(n){console.log("data is ",n.message),showSignInPage(),handleNotification("success",n.message),$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn")},error:function(n,t){if(401==n.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);handleNotification("error",n.responseJSON.err),console.log("err is ",n.responseJSON.err),$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn")}})})}function handleSignUpThroughLink(){let e=$("#sign-up-link-container");sendIntialData($("form",e))}function handleSetNewPasswordThroughLink(){let e=$("#set-new-password-link-container");sendIntialData($("form",e))}function getSetPasswordForm(e){return $(`<form action="/update-password-with-secret" method="POST">\n          <input type="hidden" value="${e}" name="secret" required />\n        \n          <input\n            class="input sign-up"\n            required\n            type="password"\n            name="password"\n            id=""\n            placeholder="New Password *"\n            onfocus="slideup(event)"\n            onfocusout="slidedown(event)"\n            autocomplete='off'\n          />\n          <input\n            class="input sign-up"\n            required\n            type="password"\n            name="confirm_password"\n            id=""\n            placeholder="Confirm Password *"\n            onfocus="slideup(event)"\n            onfocusout="slidedown(event)"\n            autocomplete='off'\n          />\n          <button>Update</button>\n        </form>`)}function get_sign_up_initial_data_form(e){return $(`<form action="/sign-up-with-secret" method="POST" >\n          <input type="hidden" value="${e}" name="secret" required />\n          <input\n            class="input sign-up"\n            required\n            type="text"\n            name="name"\n            placeholder="Name"\n            onfocus="slideup(event)"\n            onfocusout="slidedown(event)"\n            autocomplete='off'\n          />\n          <input\n            class="input sign-up"\n            required\n            type="password"\n            name="password"\n            id=""\n            placeholder="Password *"\n            onfocus="slideup(event)"\n            onfocusout="slidedown(event)"\n            autocomplete='off'\n          />\n          <input\n            class="input sign-up"\n            required\n            type="password"\n            name="confirm_password"\n            id=""\n            placeholder="Confirm Password *"\n            onfocus="slideup(event)"\n            onfocusout="slidedown(event)"\n            autocomplete='off'\n          />\n          <button>Sign-Up</button>\n        </form>`)}function verifyEmail(e){e.submit(n=>{n.preventDefault(),$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn"),$.ajax({method:"POST",url:e.prop("action"),data:e.serialize(),success:function(n){console.log("data is ",n.message);let t=n.data.secret;"signUp"==n.data.type?show_SignUp_intial_dataForm(t):"forgotPassword"==n.data.type&&show_Set_Password_Form(t),handleNotification("success",n.message),$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn")},error:function(n,t){if(401==n.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);handleNotification("error",n.responseJSON.err),console.log("error is ",t.responseText),$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn")}})})}function getOtpForSignUp(e){e.submit(n=>{n.preventDefault(),$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn"),$.ajax({method:"POST",url:e.prop("action"),data:e.serialize(),success:function(n){console.log("message is ",n.message),show_sign_up_email_verification_page(n.data.email),handleNotification("success",n.message),$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn")},error:function(n,t){if(401==n.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);handleNotification("error",n.responseJSON.err),console.log("err is ",n.responseJSON.err),$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn")}})})}function otp_resend_option(e){e.click(function(n){n.preventDefault(),$(e).toggleClass(" disable_btn_without_back"),$.ajax({method:"GET",url:e.prop("href"),success:function(n){console.log("message is ",n.message),handleNotification("success",n.message),$(e).toggleClass(" disable_btn_without_back")},error:function(n,t){if(401==n.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);handleNotification("error",n.responseJSON.err),console.log("err is ",n.responseJSON.err),$(e).toggleClass(" disable_btn_without_back")}})})}function handleNoticeLike(e){$(e).click(n=>{n.preventDefault(),$(e).toggleClass(" disable_btn_without_back"),console.log("href is ^^^^^^^ ",$(e).prop("href")),$.ajax({type:"GET",url:$(e).prop("href"),success:function(n){$(e).toggleClass(" disable_btn_without_back"),console.log("data is ",n.data.notice._id),handleLikeIconAndCount(n.data.notice,!!n.data.like,"notice"),handleNotification("success",n.message)},error:function(n,t){if($(e).toggleClass(" disable_btn_without_back"),401==n.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);console.log("err is ",n.responseText),handleNotification("error",n.responseJSON.err)}})})}function handleNotices(){console.log("handle notices running "),$(".notice").each((e,n)=>{handleNoticeLike($(".notice-like-link",n))})}function deleteByType(e){$(e).click(n=>{n.preventDefault(),$(e).toggleClass(" disable_btn_without_back"),console.log("prevent by me ^^^^^^^^^^ "),$.ajax({type:"GET",url:$(e).prop("href"),success:function(n){console.log("req successfull, message is ",n.message),$(e).toggleClass(" disable_btn_without_back"),console.log("data is ",n.data);const t=n.data.typeId,o=n.data.type;console.log("^^^^^^^^^^^^^^ ",$(`#${o}-${t}`)),$(`#${o}-${t}`).remove();let i=$(`#${o}s`);console.log("dc ^^^ ",$(i).children().length),0==$(i).children().length&&("notice"==o&&$(i).after('<div id="no-notice" style="margin: auto; font-size: 35; width: fit-content; margin-top: 50px">\n        No Notice Found\n    </div>'),i.remove()),handleNotification("success",n.message)},error:function(n,t){if($(e).toggleClass(" disable_btn_without_back"),401==n.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);console.log("err is ",n.responseJSON.err),handleNotification("error",n.responseJSON.err)}})})}function handleEditOptionByType(e,n){$(e).click(function(e){e.preventDefault();let t="toUpdate"+n,o=e.target;console.log("targte ele is ",o);let i=document.createElement("div");i.className=t,i.className+=" clickDisappear";let a=o.getAttribute("link");var s=document.createElement("a");s.innerHTML="<img src='/uploads/icons/41.delete.png' alt='delete' height='39px' width='31px' />",s.href=a,i.appendChild(s),console.log("D is ",i),console.log("paren t ************** ",o.parentNode.parentNode),"alert"==n?o.parentNode.appendChild(i):"poll"!=n&&"notice"!=n||o.parentNode.parentNode.appendChild(i),deleteByType($(s))})}function addListenerToEdit(){$(".poll-edit-link").each((e,n)=>{console.log("handle poll deletion: ",n),handleEditOptionByType(n,"poll")}),$(".alert-edit-link").each((e,n)=>{console.log("handle alert deletion: ",n),handleEditOptionByType(n,"alert")}),$(".notice-edit-link").each((e,n)=>{console.log("handle notice deletion"),handleEditOptionByType(n,"notice")})}function handlePollVoting(e){$(e).click(n=>{n.preventDefault(),$(e).parent().toggleClass(" disable_btn"),$.ajax({type:"GET",url:$(e).prop("href"),success:function(n){let t=n.data.pollId,o=$(`#yes-voting-${t}`),i=$(`#no-voting-${t}`),a=$(`#poll-votes-length-${t}`);$(o).css("pointer-events","none"),$(i).css("pointer-events","none"),$(".yes-option",o).text(n.data.yesPercent+"%"),$(".no-option",i).text(n.data.noPercent+"%"),a.length>0&&(console.log("running ^^^^^^^^^^^^^^^^^^ "),$(a).text(n.data.totalVotes+" votes")),$(e).parent().toggleClass(" disable_btn"),handleNotification("success",n.message)},error:function(n,t){if($(e).parent().toggleClass(" disable_btn"),401==n.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);console.log("err is ",n.responseJSON.err),handleNotification("error",n.responseJSON.err)}})})}function handleListenerToPollVote(){$(".vote_for_no").each((e,n)=>{handlePollVoting(n)}),$(".vote_for_yes").each((e,n)=>{handlePollVoting(n)})}function makeLinkButton(e,n){let t=null;return"connect"==e?t="withdraw":"accept"==e?t="remove":"ignore"!=e&&"withdraw"!=e&&"remove"!=e||(t="connect"),"connect"==t?$(` <a\n          class="request-link"\n          href="/user/send-request?target=${n}"\n          ><button>Connect</button></a\n        >`):"remove"==t?$(` <a\n          class="request-link"\n          href="/user/remove-membership?target=${n}"\n          ><button>Remove</button></a\n        >`):$(`  <a\n          class="request-link"\n          href="/user/withdraw-request?target=${n}"\n          ><button>Withdraw</button></a\n        >\n`)}function handleRequests(e){$(e).click(n=>{n.preventDefault(),$(e).toggleClass(" disable_btn"),$.ajax({type:"GET",url:$(e).prop("href"),success:function(n){console.log("data is ",n.message),handleNotification("success",n.message);let t=makeLinkButton(n.data.type,n.data.profileId),o=$(e).parent();$(".request-link",o).each((e,n)=>{n.remove()}),$(o).prepend(t),handleRequests(t)},error:function(n,t){if($(e).toggleClass(" disable_btn"),401==n.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);console.log("err is ",n.responseJSON.err),handleNotification("error",n.responseJSON.err)}})})}function addListenerToRequestButtons(){$(".request-link").each((e,n)=>{handleRequests(n)})}function handleNewCreateContent(e){$(e).submit(n=>{n.preventDefault();let t=domLoader();t.insertBefore($("button",e));let o=addLoader(t);$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn"),$.ajax({type:"POST",url:$(e).prop("action"),data:$(e).serialize(),success:function(n){$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn"),console.log("data is ",n),removeLoader(t,o),handleNotification("success",n.message),window.location="/"},error:function(n,i,a){if(removeLoader(t,o),$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn"),401==n.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);console.log("err textStatus is ^^ ",i," err message is ",a),handleNotification("error","timeout"==i?"Request "+a:n.responseJSON.err)},timeout:1e4})})}function addListenerToNewCreateContent(){$(".create-new-form").each((e,n)=>{handleNewCreateContent(n)})}function makeCommentDom(e,n,t,o,i){let a=`\n                    <div class="comment" id="comment-id-${e._id}">\n                        <div class="upper-div-1">\n                            <a href="/user/profile?user_id=${e.creator._id}" style="text-decoration: none">\n                                <div>\n                                    <img src="${e.creator.pic}" alt="img" height="30px" width="30px" style="border-radius: 50%;" />\n                                </div>\n                            </a>\n                            <div>\n                                <a href="/user/profile?user_id=${e.creator._id}" style="text-decoration: none; color: rgb(117, 112, 112)">\n                                    <span>${e.creator.name}</span>\n                                </a>\n                                <span class="comment-content">${e.content}</span>\n                            </div>\n                        </div>\n                        <div class="upper-div-2">\n                            <div>\n                                <span>\n                                <a\n              class="toggle-comment-like-link"\n              id="toggle-comment-like-link-${e._id}"\n              href="/user/toggle-like?id=${e._id}&type=Comment"\n              ><span id="toggle-comment-like-span-${e._id}">`;var s=!1;if(n)for(lik of e.likes)if(lik.creator==n._id){s=!0;break}return a+=s?'<img\n                  src="https://cdn-icons-png.flaticon.com/512/833/833472.png"\n                  alt="yes-like"\n                  height="25px"\n                  width="25px"\n                />':'<img\n                  src="https://cdn-icons-png.flaticon.com/512/151/151910.png"\n                  alt="no-like"\n                  height="25px"\n                  width="25px"\n                />',a+=`\n     </span></a\n            >\n                                </span><span id="comment-like-count-${e._id}">${e.likes.length}</span\n          >\n        </div>\n`,!n||e.creator._id!=n._id&&n._id!=o?a+='<div style="visibility: hidden">\n          <span style="width: 12px"></span>\n                            </div>':a+=`<div>\n          <span\n            onClick="handleEditCommentOption(event)"\n            class="edit-comment"\n            link="/user/delete-comment?comment=${e._id}&post=${t}&type=${i}"\n            >&vellip;</span\n          >\n        </div>`,a+="</div>\n                    </div>",$(a)}function addCommentdToDom(e,n,t,o,i,a){for(let s of n){let n=makeCommentDom(s,i,t,o,a);$(e).append(n),handleToggleCommentLike($(`#toggle-comment-like-link-${s._id}`,n))}}function loadMoreButton(e,n,t){return console.log("post_id ",e," time is ",n,"Type is ",t),$(`<button class='load-comment load-on-demand' id='load-comment-${e}' time=${n} type=${t} postId=${e}>Load More</button>`)}function toggleComment(e,n){console.log("post_id ^^^^^^^^^^^^^^ ",e);console.log("type is ############ %%%%%%%%% ",n);let t=$("#comment-"+e),o=$(t).css("display"),i="none"===o?"block":"none";if(console.log("newStyle ",i,"  prev Style ",o),$(t).css("display",i),"none"==i)return;let a=domLoader();$(`#all-comment-${e}`).html(""),$(t).append(a);let s=addLoader(a);$.ajax({type:"GET",url:`/get-comments-of-post?id=${e}&type=${n}`,success:async function(n){if(console.log("data is ",n.data),removeLoader(a,s),addCommentdToDom($("#all-comment-"+e,t),n.data.comments,e,n.data.postCreatorId,n.data.localUser,n.data.postType),$(`#comment-head-${e}`).text(n.data.noOfComments+" Comments"),$(`#comment-length-${e}`).text(n.data.noOfComments+" comments"),n.data.comments.length>=6){let o=loadMoreButton(e,n.data.lastTime,n.data.postType);await $("#all-comment-"+e,t).append(o),handleLoadingCommentVisiblity(o)}0==n.data.comments.length&&$("#all-comment-"+e,t).append('<div class="comment no-comment" style="text-align: center; color: rgb(31, 29, 29); box-shadow: none">\n                No comments for this post\n            </div>')},error:function(e,n){console.log("err in loading comments plzz refresh the page"),handleNotification("error",e.responseJSON.err),removeLoader(a,s)}})}function loadMoreComment(e){let n=$(e).attr("time"),t=$(e).attr("type");console.log("type is 1667 @@@@@@@@ $$$$$$$$$$$$  ",t);let o=$(e).attr("postId");$(e).css("backgroundColor","red"),console.log("time is ",n," postId is ",o);let i=domLoader();$(i).insertAfter(e),$(e).remove();let a=addLoader(i);$.ajax({type:"GET",url:`/load-more-comments-of-post?id=${o}&time=${n}&type=${t}`,success:async function(e){if(removeLoader(i,a),console.log("data is ",e),addCommentdToDom($("#all-comment-"+o),e.data.comments,o,e.data.postCreatorId,e.data.localUser,e.data.postType),e.data.comments.length>=6){console.log("data.data.postType is @@@@@@@@@ ",e.data.postType);let n=loadMoreButton(o,e.data.lastTime,e.data.postType);await $("#all-comment-"+o).append(n),handleLoadingCommentVisiblity(n)}},error:function(e,n){removeLoader(i,a),console.log("err in loading more comment is ",e.responseJSON.err),handleNotification("error",e.responseJSON.err)}})}function callpostIntialFunctions(e){intialImageDisplay(),handleTogglePostLike($(".post-like-toggle",e)),addListenerToallNextPrevBtn($(".button",e)),handleToggleSave($(".save-toggle-link",e)),addNewComment($(".some",e)),handleEvents($(".type-detail",e)),handleEventHeadText($(".event-head",e)),eventDetailToggle($(".type-detail",e)),setEventDate($(".event-time",e)),handleBack($(".event-back-btn",e)),setCreatedTime($(".created-time",e))}function addPostsToDom(e,n){let t=$(".post-class").length;console.log("count is ^^^^^^^^^^^^^^^ ",t);for(let o of n){let n=addPostToDom(e,o,t);$("#post-container").append(n),callpostIntialFunctions(n),t++}}function addPostsEventToEventDomPage(e,n,t){let o=$(".post-class").length;console.log("count is ^^^^^^^^^^^^^^^ ",o);for(let i of t){let t=addPostToDom(n,i,o);$("."+e+"-post-container").append(t),callpostIntialFunctions(t),o++}}function addPostToDom(e,n,t){let o=`            <div class="post-class  post-some-${n._id}" id="post-${t}">\n                <div class="post-header">\n                    <a class="post-creator-link" href="/user/profile?user_id=${n.creator._id}" style="text-decoration: none;">\n                        <div>\n                            <img src="${n.creator.pic}" alt="creator" />\n                            <div>\n                                <span>${n.creator.name}</span>\n                                <span style="font-size: 12; color: lightslategray;padding-left: 5px;">${n.creator.onModel}</span\n          >\n        </div>\n      </div>\n                </a>`;if(e&&n.creator._id==e._id&&(o+=`    <div class="post-edit-option">\n                \n        <span\n        onClick="handleEditPostOption(event)"\n        link="/creator/delete-post?post=${n._id}&type=${n.photos?"Post":"TextPost"}"\n        id="${t}"\n        >&vellip;</span\n      >\n      </div>`),o+="</div>",n.eventStartTime&&(o+=`<div  targetId="${n._id}-event" class="type-detail" start="${n.eventStartTime}" end="${n.eventEndTime}" location="${n.venu}" postId="${n._id}">\n        <div>  <img height="25px" width="25px" src="/uploads/icons/31.upcoming-event.png" alt="">\n      </div>\n                            <abbr title="See/Hide Event Detail" >  <img height="25px" width="25px" src="/uploads/icons/13.detail.png" alt="detail">\n</abbr>\n\n                            </div>`),o+=`<div style="padding: 5px; margin: 5px">\n                                    <span style="font-size: 15">${n.caption}</span>\n                            </div>`,n.photos){o+=` <div class="post-main-section">\n\n\n                                    <div id="displayCount-post-${n._id}">1/${n.photos.length}\n                                    </div>\n\n                                    <span class="button back" type="back" id="post-${n._id}">&#10094</span>\n                                    <span class="button next" type="next" id="post-${n._id}">&#10095</span>\n`;let e=0;for(let t of n.photos)console.log("phot o ################### ",e," jrhjvf ######### ",t),o+=`<img src="${t}"  alt="post-pic" class="post-${n._id} post" current_no="${e}" max_no="${n.photos.length}" />\n                                            `,e+=1;o+="\n                                </div>"}n.photos||(o+=`<div class="main-text-section">\n                                            ${n.content}\n                                        </div>`),o+=`\n                           <div class="post-footer">\n                                                <span>\n                <a class="post-like-toggle" postId="${n._id}" href="/user/toggle-like?id=${n._id}&type=${n.photos?"Post":"TextPost"}">\n                                 <span id="toggle-post-like-span-${n._id}">\n                                  `;let i=!1;if(e)for(lik of n.likes)if(console.log("lik is ",lik),lik.creator&&lik.creator._id==e._id){i=!0;break}o+=i?'                                     <img height="20px" width="20px" src="/uploads/icons/3.liked.png" alt="like" />\n':'        <img src="/uploads/icons/4.not_liked.png" height="25px" width="25px" alt="">\n',o+=` \n                                    </span>\n                    </a>\n\n                    <span id="post-like-count-${n._id}">${n.likes.length} likes</span>\n\n\n                    </span>\n                    <span class="comment-button" style="text-align: center"><span onclick="toggleComment('${n._id}','${n.photos?"Photo":"Text"}')" >\n          <img\n            src="/uploads/icons/5.comment_toggle.png"\n            alt="comment"\n            height="25px"\n            width="25px"\n          /> </span\n        ><span id="comment-length-${n._id}">${n.comments.length} comments</span></span>\n\n                    <span class="save-toggle-span" id="save-toggle-${n._id}">`;let a=!1;if(e)for(itm of e.saveItems)if(n._id==itm.refItem){a=!0;break}if(o+=`\n                              <a class="save-toggle-link" id="save-toggle-link-${n._id}" href="/user/toggle-to-save?refId=${n._id}&type=${n.photos?"Post":"TextPost"}"> \n                            `,o+=a?'                        <img\n          src="/uploads/icons/33.saved.png"\n          height="25px"\n          width="20px"\n          alt=""\n      /> ':'<img\n          src="/uploads/icons/34.not-saved.png"\n          height="25px"\n          width="20px"\n          alt=""\n      /> ',o+=`</a>         \n             </span>\n                    </div>\n                    <div class="likes-detail" id="likes-detail-${n._id}">`,n.likes.length>0){o+=` <div class="first-div"><span style="color: black;">${n.likes.length} people are liked this post</span> <span><a href="/user/likes?post=${n._id}&type=${n.photos?"Post":"TextPost"}">View All</a></span></div>\n                            <div>`;for(let e=0;e<7&&e<n.likes.length;e++)n.likes[e].creator&&(o+=`                                        <img src="${n.likes[e].creator.pic}" alt="pic" height="40px" width="40px" style="border-radius: 50%; padding:0px 7px 0px 7px;">\n`);o+="\n                            </div>"}return o+='\n                        \n                    </div>\n\n                    <div class="new-comment">',e&&(o+=`                            <img src="${e.pic}" alt="pic" height="35px" width="35px" style="border-radius: 50%" />\n`),o+=`\n                                <form action="/user/add-comment" method="POST" class='some'>\n                                    <input type="text" name="comment" required placeholder="Type Your Comment" id="comment-input" />\n                                    <input type="hidden" name="postId" value="${n._id}">\n                                    <input type="hidden" name="type" value="${n.photos?"Post":"TextPost"}">\n\n                                    <button style="cursor: pointer;">\n          <img\n            height="20px"\n            width="35px"\n            src="/uploads/icons/7.send-message.webp"\n            alt=""\n          />\n        </button>\n                                </form>\n                    </div>\n\n                    <div style="width: 100%; position: absolute; bottom: 0px; display: flex;flex-flow: row-reverse; color:royalblue; font-size: 13;" createdTime="${n.createdAt}" class="created-time">Post created date & time</div>\n\n                    </div>`,o+=`<div class="comment-container" id="comment-${n._id}">\n    <div class="comment-head" id="comment-head-${n._id}">\n        ${n.comments.length} Comments\n    </div>\n    <div class="comments" id="all-comment-${n._id}"></div>\n</div>`,$(o)}function loadMorePost(e){console.log("running @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ ");$(e).css("backgroundColor","red");let n=$(e).attr("photoTime"),t=$(e).attr("textTime"),o=$(e).attr("photo"),i=$(e).attr("text"),a=domLoader();$(a).insertAfter(e);let s=addLoader(a);$(e).remove(),$.ajax({type:"GET",url:`/load-more-post?photoTime=${n}&textTime=${t}&photo=${o}&text=${i}`,success:function(e){if(console.log("data is ",e),addPostsToDom(e.data.localUser,e.data.posts),removeLoader(a,s),console.log("length of loading ",e.data.posts.length),e.data.posts.length>=2){let n=loadMorePostButton(e.data.lastPhotoTime,e.data.lastTextTime,e.data.loadMorePhotoPost,e.data.loadMoreTextPost);$("#post-container").append(n),handleLoadingPostVisiblity(n)}},error:function(e,n){removeLoader(a,s),console.log("err in loading more post is ",e.responseJSON.err),handleNotification("error",e.responseJSON.err)}})}async function handleLoadingPostVisiblity(e){console.log("running ########################## "),await checkIntoView(e)&&loadMorePost(e),$(window).scroll(async()=>{await checkIntoView(e)&&loadMorePost(e)}),$(window).resize(async()=>{await checkIntoView(e)&&loadMorePost(e)})}function listenerToAddMorePost(){$(".load-post").each((e,n)=>{handleLoadingPostVisiblity(n)})}async function handleLoadingCommentVisiblity(e){await checkIntoView(e)&&loadMoreComment(e),$(window).scroll(async()=>{await checkIntoView(e)&&loadMoreComment(e)}),$(window).resize(async()=>{await checkIntoView(e)&&loadMoreComment(e)})}function listenerToLoadMoreComment(){$(".load-comment").each((e,n)=>{handleLoadingCommentVisiblity(n)})}function likeNode(e,n){let t='        <div class="like-by">';return e.creator&&(t+=`\n                        <a class="liked-user-link" href="/user/profile?user_id=${e.creator._id}" style="text-decoration: none">\n                            <div>\n                                <div>\n                                    <img src="${e.creator.pic}" alt="image" height="50px" width="50px" style="border-radius: 50%" />\n                                </div>\n                                <div>\n                                    <span>${e.creator.name} </span>\n                                    <span style="font-size: 14; color: rgb(129, 121, 121)">${e.creator.onModel}</span\n          >\n        </div>\n      </div>\n    </a>\n    <div>`,n&&("Student"==n.onModel&&"Student"!=e.creator.onModel||"Student"!=n.onModel&&"Student"==e.creator.onModel)&&(n.related.members.includes(e.creator._id)?t+=`<a\n        class="request-link"\n        href="/user/remove-membership?target=${e.creator._id}"\n        ><button>Remove</button></a\n      >`:n.related.sendRequest.includes(e.creator._id)?t+=`      <a\n        class="request-link"\n        href="/user/withdraw-request?target=${e.creator._id}"\n        ><button>Withdraw</button></a\n      >\n`:n.related.comingRequest.includes(e.creator._id)?t+=`<a\n        class="request-link"\n        href="/user/accept-request?target=${e.creator._id}"\n        ><button>Accept</button></a\n      >\n      <a\n        class="request-link"\n        href="/user/ignore-request?target=${e.creator._id}"\n        ><button>Ignore</button></a\n      >`:t+=`<a\n        class="request-link"\n        href="/user/send-request?target=${e.creator._id}"\n        ><button>Connect</button></a\n      >`),t+="\n    </div>\n    "),t+="\n  </div>",$(t)}function addLikesToPage(e,n){for(let t of e){let e=likeNode(t,n);handleRequests($(".request-link",e)),$("#likes-page").append(e)}}function addMoreLikes(e){let n=$(e).attr("postId"),t=$(e).attr("time"),o=domLoader();$(o).insertAfter(e),$(e).remove();let i=addLoader(o);$.ajax({type:"GET",url:`/user/load-more-post-likes?type=Post&time=${t}&postId=${n}`,success:function(e){if(console.log("like added successfully ",e),addLikesToPage(e.data.likes,e.data.localUser),removeLoader(o,i),e.data.likes.length>=1){let n=loadMoreLikeButton(e.data.lastTime,e.data.postId);$("#likes-page").append(n),handleLoadingLikeVisiblity(n)}},error:function(e,n){console.log("err in loading likes of post is : ",e.responseJSON.err),removeLoader(o,i),handleNotification("error",e.responseJSON.err)}})}async function handleLoadingLikeVisiblity(e){console.log("running ########################## "),await checkIntoView(e)&&addMoreLikes(e),$(window).scroll(async()=>{await checkIntoView(e)&&addMoreLikes(e)}),$(window).resize(async()=>{await checkIntoView(e)&&addMoreLikes(e)})}function addListenerToMoreLike(){$(".load-like").each((e,n)=>{handleLoadingLikeVisiblity(n)})}function noticeDom(e,n){let t=`                <div class="notice" id="notice-${e._id}">\n                    <a href="/user/profile?user_id=${e.creator._id}" style="text-decoration: none; color: black">\n                        <div class="head">\n                            <div>\n                                <img src="${e.creator.pic}" alt="" height="30px" width="30px" style="border-radius: 50%" />\n                            </div>\n                            <div style="\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n          ">\n                                <span> ${e.creator.name}</span>\n                                <sub> ${e.creator.onModel}</sub>\n                            </div>\n                        </div>\n                    </a>\n                    <div class="caption">\n                        ${e.caption}\n                    </div>\n                    <div class="content-area">\n                        \x3c!-- <img src="https://cdn.slidesharecdn.com/ss_thumbnails/sscnoticepdf-130208033612-phpapp01-thumbnail-4.jpg?cb=1360294651" alt="" height="150px" width="100px" /> --\x3e\n                        <img src="${e.image}" alt="" height="150px" width="120px" />\n                    </div>\n\n                    <div class="name">\n                        ${e.originalFileName}\n                    </div>\n                    <div class="footer">\n                        <div>\n                            <a id="toggle-notice-like-span-${e._id}" class="notice-like-link" href="/user/toggle-like?id=${e._id}&type=Notice">\n                                `;var o=!1;if(n)for(lik of e.likes)if(lik.creator==n._id){o=!0;break}return t+=o?'                                                                        <img height="25px" width="25px" class="like" alt="like" src="https://cdn-icons-png.flaticon.com/512/833/833472.png" alt="like" />\n':'   <img class="like" alt="like" src="https://cdn-icons-png.flaticon.com/512/151/151910.png" height="25px" width="25px" alt="" />\n',t+=`\n                            </a>\n                            <span id="notice-like-count-${e._id}">${e.likes.length}</span\n        >\n      </div>\n      <div>\n        <a\n          class="notice-download-link"\n          href="/user/notice-download?notice=${e._id}"\n        >\n          <img\n            height="25px"\n            class="download"\n            width="25px"\n            src="https://cdn-icons-png.flaticon.com/512/892/892634.png"\n            alt="download"\n          />\n        </a>\n        <span>${e.downloads.length}</span>\n                        </div>`,n&&e.creator._id==n._id&&(t+=`                <div style="\n          height: fit-content;\n          width: fit-content;\n          padding: 0px;\n          margin-top: 0px;\n        ">\n                                <span class="notice-edit-link" link="/user/delete-by-type?typeId=${e._id}&type=notice">&vellip;</span\n        >\n      </div>`),t+="\n            \n    </div>\n  </div>",$(t)}function addAllNoticesToPage(e,n){for(let t of e){let e=noticeDom(t,n);handleNoticeLike($(".notice-like-link",e)),handleEditOptionByType($(".notice-edit-link",e),"notice"),$("#notices").append(e)}}function addMoreNotices(e){let n=$(e).attr("time"),t=domLoader();$(t).insertAfter(e),$(e).remove();let o=addLoader(t);$.ajax({type:"GET",url:`/load-more-notice?time=${n}`,success:function(e){if(console.log("notice  loaded successfully ",e),addAllNoticesToPage(e.data.notices,e.data.localUser),removeLoader(t,o),e.data.notices.length>=1){let n=loadMoreNoticeButton(e.data.lastTime);$("#notices").append(n),handleLoadingNoticeVisiblity(n)}},error:function(e,n){console.log("err in loading notices of post is : ",e.responseJSON.err),removeLoader(t,o),handleNotification("error",e.responseJSON.err)}})}async function handleLoadingNoticeVisiblity(e){console.log("running ########################## "),await checkIntoView(e)&&addMoreNotices(e),$(window).scroll(async()=>{await checkIntoView(e)&&addMoreNotices(e)}),$(window).resize(async()=>{await checkIntoView(e)&&addMoreNotices(e)})}function addListenerToNoticesLoading(){$(".load-notice").each((e,n)=>{handleLoadingNoticeVisiblity(n)})}function eventHomeDom(e){return`<div class="event-detail">\n                            <div style="background-color: rgb(238, 237, 235)">\n                                <div>\n                                    <img src="${e.creator.pic}" alt="" height="25px" width="25px" style="border-radius: 50%" />\n                                </div>\n                                <div style="display: flex; flex-direction: column;align-items: flex-start;">\n                                    <span>${e.creator.name}</span>\n                                    <span style="color:rgb(26, 25, 25); font-size: 12;padding-left: 0px;">${e.creator.onModel}</span>\n\n                                </div>\n                            </div>\n                            <a href="/user/events">\n                                <div class="event-type">\n                                    <div>\n                                        <img height="25px" width="25px"  src="/uploads/icons/31.upcoming-event.png"  alt="" />\n                                        <span style="color: hsl(93, 100%, 49%)" class="event-head" startTime="<%=event.eventStartTime%>">Upcoming Event</span\n            >\n          </div>\n          <abbr title="See Event Detail">\n            <img\n              height="25px"\n              width="25px"\n              src="/uploads/icons/13.detail.png"\n              alt="detail"\n            />\n          </abbr>\n        </div>\n      </a>\n      <div style="position: relative">\n        <img src="${e.photos[0]}" alt="" height="150px" width="50%" style="margin:auto;" />\n        <abbr title="event have more photos"\n          ><img\n            height="25px"\n            width="25px"\n            style="position: absolute; right: 3px; top: 3px"\n            src="/uploads/icons/25.more-images.png"\n            alt="more-photo"\n        /></abbr>\n      </div>\n        <div style="font-size: 14; color: black; margin-top: 5px;">\n                                ${e.caption}\n                            </div>\n      <div\n        style="\n          font-size: 14;\n          color: rgb(54, 53, 53);\n          display: flex;\n          flex-direction: row;\n          justify-content: space-between;\n          align-items: center;\n        "\n      >\n        <div>\n           \n\n                                </div>\n\n                                <div class="event-time" style="font-size: 13; color: rgb(37, 190, 241)" timing="${e.eventStartTime}">\n                                    Date and Time of Event\n                                </div>\n                            </div>\n                          \n                    </div>`}function addAllUpcomingHome(e,n){for(let t of n){console.log("event is ",t);let n=eventHomeDom(t.postRef);setEventDate(".event-time",n),$(e).append(n)}}function toggleEventsVisibality(e){let n=document.querySelector("#"+e),t=getComputedStyle(n).maxHeight;if(n.style.maxHeight="0px"!=t?"0px":"600px",document.getElementById("arrow-up").style.transform="0px"==n.style.maxHeight?"rotate3d(1,0,0,0deg)":"rotate3d(1,0,0,180deg)","0px"==n.style.maxHeight)return;let o=$("#all_event");$(o).html("");let i=domLoader();$(o).append(i);let a=addLoader(i);$.ajax({type:"GET",url:`/load-upcoming-or-running-events?time=${Date.now()}`,success:function(e){removeLoader(i,a),e.data.events.length>0?addAllUpcomingHome(o,e.data.events):$(o).append('<div style="\n        border-top: 1px solid black;\n        color: tomato;\n        text-align: center;\n        padding: 10px;\n        margin: 15px;\n      ">\n                    No Upcoming or Runnning Event\n                </div>'),console.log("data is ",e)},error:function(e,n){console.log("err in loading current or upcoming events  is : ",e.responseJSON.err),removeLoader(i,a),handleNotification("error",e.responseJSON.err)}})}function MakeEventPageLoadBtn(e,n){return $(` <button time="${e}" type="${n}" class="load-event load-on-demand">Load more ${n}</button>`)}function noEventFind(e){return $(`<div class="no-event-box">${"upcoming"==e?"No Upcoming or Current Event Found":"No Passed Event Found"}</div>`)}async function handleLoadingEventVisiblity(e){console.log("running ########################## "),await checkIntoView(e)&&handleLoadingEvent(e),$(window).scroll(async()=>{await checkIntoView(e)&&handleLoadingEvent(e)}),$(window).resize(async()=>{await checkIntoView(e)&&handleLoadingEvent(e)})}async function handleLoadingEvent(e){let n=$(e).attr("time"),t=$(e).attr("type");let o=domLoader(),i=$("#"+t);$(i).append(o);let a=addLoader(o);$(e).remove(),await $.ajax({type:"GET",url:`/user/load-event-for-event-page?type=${t}&time=${n}`,success:async function(e){removeLoader(o,a),console.log("data is ",e),addPostsEventToEventDomPage(t,e.data.localUser,e.data.events);let n=$("."+t+"-post-container");if(e.data.events.length>=2){let o=MakeEventPageLoadBtn(e.data.lastTime,t);$(n).append(o),handleLoadingEventVisiblity(o)}else{0==$(n).children().length&&$(n).append(noEventFind(t))}},error:function(e,n){console.log("err in loading  events  is : ",e.responseJSON.err),removeLoader(o,a),handleNotification("error",e.responseJSON.err)}})}function handleFullEventLoading(){console.log("length is ######### ",$(".load-event").length),$(".load-event").each((e,n)=>{handleLoadingEventVisiblity(n)})}async function checkIntoView(e){let n=$(e).get(0).getBoundingClientRect();return n.bottom>0&&n.top<window.innerHeight}function handleNewCreatorRequest(e){$(e).submit(n=>{n.preventDefault();let t=domLoader();t.insertAfter($(e));let o=addLoader(t);$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn"),$.ajax({type:"POST",url:$(e).prop("action"),data:$(e).serialize(),success:function(n){console.log("data is ",n.data),$(e).trigger("reset"),handleNotification("success",n.message),removeLoader(t,o),$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn")},error:function(n,i,a){if(removeLoader(t,o),$(e).toggleClass(" disable_btn_without_back"),$("button",e).toggleClass(" disable_btn"),401==n.status)return console.log("redirect to login"),handleNotification("error","Unauthorized, Sign-In first"),void setTimeout(function(){window.location.href="/sign-in"},600);handleNotification("error","timeout"==i?"Request "+a:n.responseJSON.err)},timeout:1e4})})}function handleActiveCreatorPage(){$("#request-new-creator-account-container").toggleClass(" active_display")}function disappearCreatorRequestPage(){$("#request-new-creator-account-container").removeClass(" active_display")}listenerToAddNewComment(),addNewComment(),tooggleCommentLikes(),togglePostLike(),toggleSavePost(),handleDeleteComment(),handleDeletePost(),showSignInPage(),handleSignUpThroughLink(),handleSetNewPasswordThroughLink(),handleNotices(),addListenerToEdit(),handleListenerToPollVote(),addListenerToRequestButtons(),addListenerToNewCreateContent(),document.addEventListener("mouseup",function(e){let n=$(".clickDisappear")[0];n&&!n.contains(e.target)&&$(".clickDisappear").remove()}),listenerToAddMorePost(),listenerToLoadMoreComment(),addListenerToMoreLike(),addListenerToNoticesLoading(),handleFullEventLoading(),handleNewCreatorRequest($("#new-creator-request-form"));